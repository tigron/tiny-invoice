{% extends "_default/layout.base.twig" %}

{% import '_default/macro.base.twig' as base %}
{% import '_default/form.base.twig' as form %}

{% block content %}

	{% if env.module.get_name() != 'administrative_user' %}

		<div class="row">
			<div class="col">
				<h4>{% trans "Users" %}</h4>
			</div>
			<div class="col">
				<div class="float-md-end">
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb">
							<li class="breadcrumb-item">
								<a href="/administrative/user">
									{% trans "Users" %}
								</a>
							</li>
							<li class="breadcrumb-item active">
								{% trans "User" %} {{ user.username }}
							</li>
						</ol>
					</nav>
				</div>
			</div>
		</div>

		<div class="card">
			<div class="card-header">
				<ul class="nav nav-pills flex-column flex-sm-row nav-fill">
					<li class="nav-item">
						<a href="/administrative/user/detail?id={{ user.id }}" class="nav-link {% if env.module.get_name() == 'administrative_user_detail' %}active{% endif %}">
							{% trans "Details" %}
						</a>
					</li>
					<li class="nav-item">
						<a href="/administrative/user/mobile?id={{ user.id }}" class="nav-link {% if env.module.get_name() == 'administrative_user_mobile' %}active{% endif %}">
							{% trans "Mobile" %}
						</a>
					</li>
				</ul>
			</div>

			<div class="card-body tab-content">
				<div class="tab-pane show active">
					{% block tab %}{% endblock tab %}
				</div>
			</div>
		</div>

	{% elseif action == 'add' %}

		{% include 'administrative/user/add.twig' %}

	{% else %}

		<div class="col">
			<h4>{% trans "Users" %}</h4>
		</div>

		{% if env.sticky_session.message is defined %}
			{{ base.alert('success', 'User added successfully'|trans, false, 'offset-0', 'col-12') }}
		{% endif %}

		<div class="card">
			<div class="card-header">
				<div class="pull-right">
					<a href="/administrative/user?action=add" title="">
						<i data-feather="plus"></i>
						{% trans "Add user" %}
					</a>
				</div>
				{{ base.pager_count(pager.item_count) }}
			</div>
			<div class="card-body table-responsive">
			{% for user in pager.items %}
				{% if loop.first %}
					<table class="table table-hover table-striped table-condensed">
					<thead>
						<tr>
							<th>#</th>
							<th>{{ pager.create_header('First name'|trans, 'firstname')|raw }}</th>
							<th>{{ pager.create_header('Last name'|trans, 'lastname')|raw }}</th>
							<th>{{ pager.create_header('Username'|trans, 'username')|raw }}</th>
							<th>{{ pager.create_header('Role'|trans, 'role.name')|raw }}</th>
							<th width="30">&nbsp;</th>
							<th width="30">&nbsp;</th>
						</tr>
					</thead>
					<tbody>
				{% endif %}

					<tr>
						<td>{{ user.id }}</td>
						<td>{{ user.firstname }}</td>
						<td>{{ user.lastname }}</td>
						<td>{{ user.username }}</td>
						<td>{{ user.role.name }}</td>
						<td>
							<a href="/administrative/user/detail?id={{ user.id }}" title="">
								<i data-feather="edit"></i>
							</a>
						</td>
						<td>
						{% if env.session.user.id != user.id %}
							<a href="/administrative/user?id={{ user.id }}&action=delete" data-confirm-title="{% trans "Please confirm" %}" data-confirm-message="{% trans "Are you sure you want to remove this user?" %}">
								<i data-feather="trash-2"></i>
							</a>
						{% endif %}
						</td>
					</tr>

				{% if loop.last %}
					</tbody>
					</table>

					{{ pager.links|raw }}
				{% endif %}
			{% endfor %}
			</div>
		</div>

	{% endif %}

{% endblock content %}
