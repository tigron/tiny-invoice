{% extends "_default/layout.base.twig" %}

{% import '_default/macro.base.twig' as base %}
{% import '_default/form.base.twig' as form %}

{% block content %}

	{% if action == 'edit' %}

		{% include 'sales/product/type/edit.twig' %}

	{% elseif action == 'add' %}

		<div class="row">
			<div class="col">
				<h4>{% trans "Product definitions" %}</h4>
			</div>
			<div class="col">
				<div class="float-end">
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb">
							<li class="breadcrumb-item">
								<a href="/sales/product/type">
									{% trans "Product definitions" %}
								</a>
							</li>
							<li class="breadcrumb-item active">
								{% trans "Add product definition" %}
							</li>
						</ol>
					</nav>
				</div>
			</div>
		</div>

		{% if errors is defined %}
			{{ base.alert('danger', "The form contains mistakes. Please correct them."|trans)  }}
		{% endif %}

		<div class="card">
			<div class="card-header">
				{% trans "Details" %}
			</div>
			<div class="card-body">
				<form class="form form-horizontal form-condensed" method="post" action="/sales/product/type?action=add">
					<div class="row mb-1 mb-md-3{% if 'name' in errors|keys %} has-error{% endif %}">
						<label for="username" class="col-form-label col-3 text-end">{% trans "Name" %}</label>
						<div class="col-9">
							<input type="text" name="product_type[name]" id="name" class="form-control" value="{{ env.post.product_type.name }}">
							{{ form.invalid_input('name', errors) }}
						</div>
					</div>

					<div class="row mb-1 mb-md-3{% if 'name' in errors|keys %} has-error{% endif %}">
						<label for="username" class="col-form-label col-3 text-end">{% trans "Identifier" %}</label>
						<div class="col-9">
							<input type="text" name="product_type[identifier]" id="name" class="form-control" value="{{ env.post.product_type.identifier }}">
							{{ form.invalid_input('name', errors) }}
						</div>
					</div>

					<div class="row mb-1 mb-md-3">
						<div class="col-3 offset-3">
							<button class="btn btn-primary">
								{% trans "Save" %}
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>


	{% else %}

		<div class="row">
			<div class="col">
				<h4>{% trans "Invoices" %}</h4>
			</div>
		</div>

		<form class="form-horizontal" method="post" action="/sales/product/type">
		<div class="card mb-3">
			<div class="card-header">
				{% trans "Filter" %}
			</div>
			<div class="card-body">
				<div class="row mb-1 mb-md-3">
					<label class="col-form-label col-12 col-md-3 text-md-end">{% trans "Search" %}</label>
					<div class="col-9">
						<input type="text" class="form-control" name="search" value="{{ pager.get_search() }}"/>
					</div>
				</div>

				<div class="row mb-1 mb-md-3">
					<div class="controls offset-2 col-9">
						<button class="btn btn-primary" type="submit">
							{% trans "Search" %}
						</button>
					</div>
				</div>
			</div>
		</div>
		</form>

		<div class="card">
			<div class="card-header">
				<div class="pull-right">
					<a href="/sales/product/type?action=add">
						<i data-feather="plus"></i>
						{% trans "Add product definition" %}
					</a>
				</div>

				{{ base.pager_count(pager.item_count) }}
			</div>
			<div class="card-body">
				{% for product_type in pager.items %}
					{% if loop.first %}
					<table class="table table-striped table-hover table-condensed">
						<thead>
							<tr>
								<th>{{ pager.create_header('Name'|trans, 'name')|raw }}</th>
								<th>{{ pager.create_header('Identifier'|trans, 'identifier')|raw }}</th>
								<th width="20">&nbsp;</th>
								<th width="20">&nbsp;</th>
							</tr>
						</thead>
						<tbody>
					{% endif %}
					<tr>
						<td>{{ product_type.name }}</td>
						<td>{{ product_type.identifier }}</td>

						<td>
							<a href="/sales/product/type?id={{ product_type.id }}&action=edit">
								<i data-feather="edit"></i>
							</a>
						</td>
						<td>
							<a href="/sales/product/type?id={{ product_type.id }}&action=delete" data-confirm-title="{% trans "Please confirm" %}" data-confirm-message="{% trans "Are you sure" %}?">
								<span class="glyphicon glyphicon-remove"></span>
							</a>
						</td>
					</tr>

					{% if loop.last %}
						</tbody>
					</table>
					{{ pager.links|raw }}
					{% endif %}
				{% else %}

					<p><em>{% trans "No product definitions." %}</em></p>

				{% endfor %}
			</div>
		</div>

	{% endif %}

{% endblock content %}
